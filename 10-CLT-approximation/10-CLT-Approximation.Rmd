---
title: "10-CLT-approximation"
output: html_notebook
author: 'Shaswat Rajput'
---

# Simulation Study --- Central Limit Theorum

The central limit theorem is an important computational short-cut for generating and making inference from the sampling distribution of the mean. Central Limit Theorem short-cut relies on a number of conditions, specifically:

<li>Independent observations</li>
<li>Identically distributed observations</li>
<li>Mean and variance exist</li>
<li>Sample size large enough for convergence</li><br>

In this blog, we are going to compare the sampling distribution of the mean generated by simulation to the sampling distribution implied by the central limit theorem. We will compare the distributions graphically in QQ-plots.<br>
The first factor will be the sample size, with N = 5, 10, 20, and 40. The second factor will be the degree of skewness in the underlying distribution. The underlying distribution will be the Skew-Normal distribution. The Skew-Normal distribution has three parameters: location, scale, and slant. When the slant parameter is 0, the distribution reverts to the normal distribution. As the slant parameter increases, the distribution becomes increasingly skewed. In this simulation, slant will be set to 0, 2, 10, 100. 

## Setup:
<li> Sample sizes will be N = 5, 10, 20, and 40.</li>
<li> We will generate a sampling distribution of 5000 draws from both the CLT approximation and the simulation approximation.</li>
<li> Slant will be set to 0, 2, 10, 100.</li>
<li> For all the simualtion, location and scale are set  to 0 and 1 respectively.</li>

## Simulation:

Importing the required library:
```{r}
library(sn)
```

Setting the non-changable parameters ---
```{r}
R <- 5000
location <-  0
scale <- 1
sample_dist_clt<-NA
sample_dist_sim <- NA
```

Setting the Slant and Sample Sizes(N) for simulation:
In this code chunk we are calculating the population mean and sd for different slant values. Then according to different sample sizes we are simulating our result to find the values and by CLT. Then we are plotting the qqplot for differernt distibutions with different N and slant values.

```{r, fig.width=6, fig.height=6}
par(mfrow = c(4,4))
for (j in c(0,2,10,100)){
slant <- j
delta <- slant/sqrt(1+(slant)^2)
pop_mean <- location + scale* delta *(sqrt(2/pi))
pop_sd <- sqrt(scale^2*(1-((2*delta^2)/pi)))
for (i in c(5,10,20,40)){
N <- i
Z <- rnorm(R)
sample_dist_clt <- Z*(pop_sd/sqrt(N))+pop_mean
random.skew <- array(rsn(R*N,xi = location, omega = scale, alpha = slant), dim=c(N,R))
sample_dist_sim <- apply(random.skew,2,mean)
# QQ plot

qqplot(sample_dist_sim,sample_dist_clt,asp = 1,xlab = 'Simulated Values',ylab=sprintf("CLT Values with Slant = %.1i", j))
box()
abline(0,1)
mtext(sprintf("N = %i", i),side=3)

}
}
```

## Conclusion:
As we can infer from the above QQ plot that as we increase the sample size the CLT calculated values and simulated values falls within the standard normal reference, hence the sample match closely to the theoretical values, therefore, the  population distribution is approximately becoming normal.
Even as we increase the slant values and increase the N values we can see that  population distribution is approximately becoming normal ie the  values falls within the standard normal reference.


